<!DOCTYPE html>
<html lang="pa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adheyatamak Rules - Daily Checklist</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Gurmukhi:wght@400;700;800&display=swap" rel="stylesheet">

<style>

body {
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-family: "Noto Sans Gurmukhi", sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(180deg, #f5f3f7 0%, #f3f4f6 100%);
  min-height: 100vh;
  overflow-x: hidden;
}


/* üå∏ Header visual refinement */

header {
  width: 100%;
  text-align: center;
backdrop-filter: saturate(1.1);
  background: linear-gradient(
    180deg,
    #6a1b9a 0%,
    #4a148c 100%
  );
  color: #fff;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
}

header .main {
  padding: 18px 16px 20px;
}

/* üåø Header Line 1 ‚Äì spiritual banner */
#headerLine1 {
  display: inline-block;
  font-size: 1.7rem;          /* ‚¨ÜÔ∏è clearly bigger */
  font-weight: 900;           /* stronger presence */
  line-height: 1.35;
  margin: 0 auto 8px;

  padding: 8px 18px;          /* more breathing room */
  border-radius: 999px;

  background: rgba(255,255,255,0.18);
  color: #fff;

  letter-spacing: 0.5px;      /* subtle refinement */
}


/* üå∫ Header Title ‚Äì main page title */
#headerTitle {
  font-size: 1.15rem;
  font-weight: 700;
  line-height: 1.5;
  margin: 0;

  padding: 4px 6px;
  color: #f3e5f5;
}

.title-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Primary spiritual title */
#headerLine1 {
  position: relative;
  margin-bottom: 6px;
  z-index: 1;
}

/* Soft halo glow */
#headerLine1::before {
  content: "";
  position: absolute;
  inset: -12px -28px;
  background: radial-gradient(
    circle at center,
    rgba(255,255,255,0.35),
    rgba(255,255,255,0.08),
    transparent 70%
  );
  border-radius: 999px;
  z-index: -1;
}

/* Secondary line ‚Äì calm spacing */
#headerTitle {
  margin-top: 2px;
  opacity: 0.95;
}



.main {
  width: 100%;
  max-width: 600px;
  margin: 0 auto;
  padding: 0 12px;
  box-sizing: border-box;
}




#chartMonth {
  text-align: center;
  font-weight: bold;
  font-size: 1rem;
  color: #4a148c;
  margin: 12px 0 4px;   /* top | left-right | bottom */
}


.chart-wrapper {
  width: 100%;
  margin: 0;
  padding: 0;
}



.chartContainer {
  display: none; /* Hide the chart by default */
  width: 100%;
  height: 150px;
  max-width: 100%;
  overflow: visible;
  margin-bottom: 16px;
}

.toggleChartBtn {
  background: none;
  border: none;
  font-size: 1.2rem;
  font-weight: bold;
  color: #4a148c;
  cursor: pointer;
  margin-right: 6px;
}

.chart-title {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.chart-title button {
  margin-left: 10px;
}



.lang-row {
  width: 100%;
  margin: 12px 0 16px;

  display: flex;
  flex-direction: column;
  align-items: center;

  /* visual highlight */
  background: #ede7f6;
  padding: 12px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(142,36,170,0.25);

  position: relative;
}



.lang-label {
  font-size: 0.85rem;
  font-weight: 800;
  color: #6a1b9a;
  margin-bottom: 4px;
}


#dateNav {
  width: 100%;
  margin: 12px 0;
  display: flex;
  flex-direction: column;
  gap: 10px;
}


/* Wider screens ‚Üí horizontal */
@media (min-width: 480px) {
  #dateNav {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
}


/* üîò Date navigation buttons ‚Äì BASE STYLE */
.navButton {
  font-size: 2.2rem;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: #ede7f6;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  transition: all 0.25s ease;
  color: #4a148c;
  box-shadow: 0 3px 10px rgba(142,36,170,0.45);
}

/* üìÖ Current date display */
#dateDisplay {
  font-size: 1.05rem;
  font-weight: 800;
  color: #4a148c;
  background: #ede7f6;
  padding: 8px 14px;
  border-radius: 999px;
  box-shadow: 0 0 8px rgba(142,36,170,0.25);
  white-space: nowrap;
}


.navButton:hover {
  background: #d1c4e9;
  box-shadow: 0 5px 16px rgba(142,36,170,0.65);
}

@media (max-width: 360px) {
  .navButton {
    width: 50px;
    height: 50px;
    font-size: 2rem;
  }
}

  #toggleMonth, #todayBtn {
    padding:8px 15px; font-size:1rem; font-weight:bold;
    border:none; border-radius:6px; background:#8e24aa; color:#fff;
    cursor:pointer; box-shadow:0 1px 3px rgba(0,0,0,0.2);
    transition:background 0.3s;
  }
  #toggleMonth:hover, #todayBtn:hover { background:#a156d6;}

#checklist {
  width: 100%;
  margin-bottom: 20px;
}

  .item {
    display:grid; grid-template-columns:1fr 50px; align-items:center;
    background:#fff; padding:10px 15px; margin:8px 0;
    border-radius:8px; font-weight:bold; font-size:1rem;
    box-shadow:
  0 2px 8px rgba(0,0,0,0.08),
  0 0 12px rgba(142,36,170,0.25);
    transition:box-shadow 0.3s;
  }
  .item:hover { box-shadow:0 0 15px rgba(142,36,170,0.8);transform: translateY(-1px);}
  .item span { padding-right:10px; }
html[lang="pa"] .item span {
  font-size: 1.06em;
  line-height: 1.6;
}
  .item input[type="checkbox"] {
transform: scale(1.15);
box-shadow:
    0 0 6px #2e7d32,
    0 0 14px rgba(102,187,106,0.7);
    justify-self:center; width:24px; height:24px; cursor:pointer;
    accent-color:#2e7d32; transition:transform 0.2s, box-shadow 0.3s;
  }
  .item input[type="checkbox"]:checked { 
    transform:scale(1.2);
    box-shadow: 0 0 10px #2e7d32, 0 0 20px #66bb6a, 0 0 30px #a5d6a7;
animation: blessing 0.35s ease-out;
  }

@keyframes blessing {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.3); }
  100% { transform: scale(1.2); }
}

 .habit-block {
    background: transparent;
  }

.input-label {
  display: inline-block;
  font-weight: 800;
  font-size: 0.99rem;
  color: #4a148c;

  background: #ede7f6;
  padding: 4px 10px;
  border-radius: 6px;

  margin-bottom: 6px;
}

.input-group {
  background: #ede7f6;
  padding: 10px 12px 14px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(142,36,170,0.25);
  margin-bottom: 12px;
}




#checklist select {
  width: 100%;
  height: 44px;
  font-size: 1rem;
  background-color: #fff;
  border-radius: 8px;
  border: 1px solid #ccc;
}

.jaap-block {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

.jaap-count {
  width: 50%;
  max-width: 220px;
}

@media (max-width: 420px) {
  .jaap-count {
    width: 100%;
  }
}

.date-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.action-row {
  display: flex;
  gap: 10px;
}

/* Mobile: stack buttons */
@media (max-width: 480px) {
  .action-row {
    flex-direction: column;
  }
}

/* Desktop: buttons inline */
@media (min-width: 481px) {
  .action-row {
    justify-content: center;
  }
}


.simran-block,
.jaap-block {
  padding: 0;
}

.simran-row {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.simran-row .input-group {
  flex: 1;
}

.add-simran-btn {
  background: #ede7f6;
  border: 1px solid #d1c4e9;
  border-radius: 8px;
  padding: 8px 12px;
  font-weight: 800;
  color: #4a148c;
  cursor: pointer;
}

.simran-col {
  flex: 1;
}


  /* Month modal */
/* Month modal */
#monthModal { 
  display:none;
  position:fixed;
  top:4%;
  left:50%;
  transform:translateX(-50%);
  width:96%;
  max-width:820px;           /* ‚úÖ wider */
  height:92vh;               /* ‚úÖ taller */
  background:rgba(0,0,0,0.4); 
  align-items:flex-start;
  justify-content:center;
  z-index:1000;
  overflow:visible;           /* ‚úÖ prevent double scroll */
}

#monthContent {
  background:#fff;
  padding: 8px 12px 12px;
  padding-top: 2px;
  border-radius:16px;     /* ‚¨ÜÔ∏è nicer rounding */
  width:100%;
  height:100%;
  overflow:hidden;        /* ‚úÖ KEEP here */
  display:flex;
  flex-direction:column;
}


.monthHeader {
 padding-top: 6px;
  position: relative;
  height: 44px;                /* ‚úÖ reserved space */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.monthHeader h2 {
  margin: 0;
  font-size: 1.2rem;
}

.closeModal {
  position: absolute;
  left: 8px;
  top: 50%;
  transform: translateY(-50%);

  width: 40px;
  height: 40px;
  border-radius: 50%;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 1.8rem;
  font-weight: 900;
  line-height: 1;

  background: #ede7f6;
  color: #4a148c;

  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.25);
  transition: transform 0.15s ease, background 0.2s ease;
}

.closeModal:hover {
  background: #d1c4e9;
  transform: translateY(-50%) scale(1.1);
}


#monthView {
  flex: 1;
  overflow-y: auto;     /* ‚úÖ allow scroll if needed */
  overscroll-behavior: contain;
padding-bottom: 12px;  
}

#monthView::-webkit-scrollbar {
  width: 6px;
}

#monthView::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.15);
  border-radius: 6px;
}


  #monthContent h2 { text-align:center;  margin-top: 0; margin-bottom:6px; }
  .month-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:5px;}
.day {
  padding:6px;
  text-align:center;
  font-size:0.85rem;
  font-weight:bold;
  border-radius:6px;
  cursor:pointer;
  min-height:88px;           /* ‚úÖ key fix */
  display:flex;
  flex-direction:column;
  align-items:center;
}

.day > div {
  margin-bottom: 3px;
}

  .day.empty { background:transparent; cursor:default; }
  .day.future { opacity:0.4; cursor:not-allowed;}

.day.today {
  outline: 2px solid #8e24aa;
  outline-offset: -2px;
  box-shadow: 0 0 10px rgba(142,36,170,0.4);
}

/* Remove background for all simran rows */
.simran-sessions .simran-row {
  background: transparent;
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: flex-start; /* default for new sittings */
  margin-bottom: 10px;
}

/* Center only the first sitting */
.simran-sessions .simran-row:first-child {
  justify-content: center;
}

/* Input group style for uniform padding */
.simran-sessions .simran-row .input-group {
  background: #ede7f6;
  padding: 6px 10px;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Delete button style: just icon, right-aligned */
.simran-sessions .simran-row .delete-sitting-btn {
  background: none;
  color: #b71c1c;
  padding: 0;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  margin: 4px auto 0 auto; /* top margin, horizontally centered */
  display: block;          /* makes margin:auto work */
}

footer {
  width:100%;
  text-align:center;
  background:#4a148c;
  color:#fff;
  font-weight:bold;
  font-size:1rem;
  margin-top:auto;
}

#footerText {
  letter-spacing: 0.8px;
  opacity: 0.9;
}


header .main,
footer .main {
  padding: 20px;
}

#languageSelect {
 text-align: center;
 text-align-last: center;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;

  padding: 12px 44px 12px 14px;
  font-size: 1.05rem;
  font-weight: 800;

  border-radius: 10px;
  border: 2px solid #8e24aa;

  background-color: #f3e5f5;
  color: #4a148c;

  min-width: 160px;
  cursor: pointer;

  box-shadow: 0 0 0 3px rgba(142,36,170,0.3);

  /* ‚úÖ dropdown arrow */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%234a148c' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 14px center;
  background-size: 18px;
}

select:focus,
button:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(142,36,170,0.35);
}




</style>
</head>
<body>


<header>
  <div class="main">
<div class="title-wrap">
  <h1 id="headerLine1"></h1>
  <h1 id="headerTitle"></h1>
</div>


  </div>
</header>



<div class="main">

<div class="lang-row">
<label class="lang-label" for="languageSelect">Language / ‡®≠‡®æ‡®∏‡®º‡®æ / ‡§≠‡§æ‡§∑‡§æ</label>
<select id="languageSelect">
    <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
    <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
    <option value="en">English</option>
  </select>
</div>


<div id="chartMonth"></div>

<div class="chart-wrapper">
  <h3 class="chart-title">
    <button class="toggleChartBtn"
      onclick="toggleChart('habitChart', this)">‚ñº</button>
    <span id="chartTitleHabits"></span>
  </h3>

  <div class="chartContainer" id="habitChartContainer" style="display:none">
    <canvas id="habitChart"></canvas>
  </div>
</div>

<div class="chart-wrapper">
  <h3 class="chart-title">
    <button class="toggleChartBtn"
      onclick="toggleChart('simranChart', this)">‚ñº</button>
    <span id="chartTitleSimran"></span>
  </h3>

  <div class="chartContainer" id="simranChartContainer" style="display:none">
    <canvas id="simranChart"></canvas>
  </div>
</div>


<div class="chart-wrapper">
  <h3 class="chart-title">
    <button class="toggleChartBtn"
      onclick="toggleChart('jaapChart', this)">‚ñº</button>
    <span id="chartTitleJaap"></span>
  </h3>

  <div class="chartContainer" id="jaapChartContainer" style="display:none">
    <canvas id="jaapChart"></canvas>
  </div>
</div>



<!-- DATE ROW -->
<div id="dateNav">

  <div class="date-row">
    <div id="prevDay" class="navButton">&#8592;</div>
    <div id="dateDisplay"></div>
    <div id="nextDay" class="navButton">&#8594;</div>
  </div>

  <div class="action-row">
    <button id="todayBtn"></button>
    <button id="toggleMonth"></button>
  </div>

</div>


  <div id="checklist"></div>

</div>

<!-- Modal for month calendar -->
<div id="monthModal">
  <div id="monthContent">
    <div class="monthHeader">
  <span class="closeModal" id="closeModal">&times;</span>
  <h2 id="monthTitle"></h2>
</div>
<div id="monthView"></div>
  </div>
</div>

<footer>
  <div class="main" id="footerText"></div>
</footer>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<script>
const STORAGE = "spiritualChecklist";
let currentDate = new Date(); // uses local time

const monthNames = {
  en: [
    "January","February","March","April","May","June",
    "July","August","September","October","November","December"
  ],
  pa: [
    "‡®ú‡®®‡®µ‡®∞‡©Ä","‡®´‡®∞‡®µ‡®∞‡©Ä","‡®Æ‡®æ‡®∞‡®ö","‡®Ö‡®™‡©ç‡®∞‡©à‡®≤","‡®Æ‡®à","‡®ú‡©Ç‡®®",
    "‡®ú‡©Å‡®≤‡®æ‡®à","‡®Ö‡®ó‡®∏‡®§","‡®∏‡®§‡©∞‡®¨‡®∞","‡®Ö‡®ï‡®§‡©Ç‡®¨‡®∞","‡®®‡®µ‡©∞‡®¨‡®∞","‡®¶‡®∏‡©∞‡®¨‡®∞"
  ],
  hi: [
    "‡§ú‡§®‡§µ‡§∞‡•Ä","‡§´‡§º‡§∞‡§µ‡§∞‡•Ä","‡§Æ‡§æ‡§∞‡•ç‡§ö","‡§Ö‡§™‡•ç‡§∞‡•à‡§≤","‡§Æ‡§à","‡§ú‡•Ç‡§®",
    "‡§ú‡•Å‡§≤‡§æ‡§à","‡§Ö‡§ó‡§∏‡•ç‡§§","‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞","‡§Ö‡§ï‡•ç‡§ü‡•Ç‡§¨‡§∞","‡§®‡§µ‡§Ç‡§¨‡§∞","‡§¶‡§ø‡§∏‡§Ç‡§¨‡§∞"
  ]
};


// Auto-update at local midnight
setInterval(() => { 
  const now = new Date();
  if (dateKey(now) !== dateKey(currentDate)) {
    currentDate = now;
    loadDay();
    updateChart();
  }
}, 60 * 1000); // checks every minute


function dateKey(d){
  return d.getFullYear() + "-" +
         String(d.getMonth() + 1).padStart(2, "0") + "-" +
         String(d.getDate()).padStart(2, "0");
}


function format(d){
  const lang = document.documentElement.lang || "en";
  const day = d.getDate();
  const month = monthNames[lang][d.getMonth()];
  const year = d.getFullYear();

  return `${day} ${month} ${year}`;
}



function updateChartMonthTitle(lang) {
  const month = monthNames[lang][currentDate.getMonth()];
  const year = currentDate.getFullYear();

  document.getElementById("chartMonth").textContent =
    `${month} ${year}`;
}


const habitKeys = [
  "h1","h2","h3","h4","h5","h6","h7"
];


document.getElementById("checklist").innerHTML = habitKeys.map((key,i)=>`
<div class="habit-block">
  <label class="item">
 <span id="habit-${i}"></span>
    <input type="checkbox" data-index="${i}">
  </label>


${i===3 ? `
<div class="simran-block" data-habit="3">
  <div class="simran-sessions"></div>

  <button type="button" class="add-simran-btn">
    + Add Sitting
  </button>
</div>

` : ""}



${i===4 ? `
<div class="jaap-block input-group" data-habit="4">
<label class="input-label label-jaap"></label>
  <select class="jaap-count">

    <option value="0">0</option>
    ${Array.from({ length: 150 }, (_, i) => {
      const v = (i + 1) * 1000;
      return `<option value="${v}">${v.toLocaleString()}</option>`;
    }).join("")}
  </select>
</div>


` : ""}
</div>
`).join("");


function loadDay() {
  document.getElementById("dateDisplay").textContent = format(currentDate);
  const all = JSON.parse(localStorage.getItem(STORAGE)) || {};
  const day = all[dateKey(currentDate)] || { checks: {} };
  const today = new Date();

  // ‚úÖ Checkbox states and toggle input blocks
  document.querySelectorAll("#checklist input[type='checkbox']").forEach(cb => {
    const index = cb.dataset.index;

    cb.checked = day.checks?.[index] || false;
    cb.disabled = dateKey(currentDate) > dateKey(today);

    // Habit 4 ‚Äì Simran block toggle
    if (index == 3) {
      const block = document.querySelector('.simran-block[data-habit="3"]');
      if (block) {
        block.style.display = cb.checked ? "block" : "none";
        // enable/disable button
        const btn = block.querySelector(".add-simran-btn");
        if (btn) btn.disabled = !cb.checked;
      }
    }

    // Habit 5 ‚Äì Jaap block toggle
    if (index == 4) {
      const block = cb.closest(".habit-block").querySelector(".jaap-block");
      const select = block.querySelector(".jaap-count");

      block.style.display = cb.checked ? "block" : "none";
      select.disabled = !cb.checked || dateKey(currentDate) > dateKey(today);
      select.value = day.jaapCount ?? "0";

      select.onchange = () => {
        day.jaapCount = select.value || undefined;
        all[dateKey(currentDate)] = day;
        localStorage.setItem(STORAGE, JSON.stringify(all));
        updateChart();
      };
    }

    cb.onchange = () => {
      day.checks = day.checks || {};
      day.checks[index] = cb.checked;

      // Habit 4 ‚Äì Simran live toggle
      if (index == 3) {
        const block = document.querySelector('.simran-block[data-habit="3"]');
        if (block) {
          block.style.display = cb.checked ? "block" : "none";
          const btn = block.querySelector(".add-simran-btn");
          if (btn) btn.disabled = !cb.checked;

          if (!cb.checked) day.simranSessions = [];
        }
      }

      // Habit 5 ‚Äì Jaap live toggle
      if (index == 4) {
        const block = cb.closest(".habit-block").querySelector(".jaap-block");
        const select = block.querySelector(".jaap-count");

        block.style.display = cb.checked ? "block" : "none";
        select.disabled = !cb.checked;

        if (!cb.checked) {
          select.value = "0";
          delete day.jaapCount;
        }
      }

      all[dateKey(currentDate)] = day;
      localStorage.setItem(STORAGE, JSON.stringify(all));
      buildMonth();
      updateChart();
    };
  });

// Habit 4 ‚Äì Simran rendering & Add Sitting button
const addBtn = document.querySelector(".add-simran-btn");
if (addBtn) {
  addBtn.onclick = () => {
    const all = JSON.parse(localStorage.getItem(STORAGE)) || {};
    const day = all[dateKey(currentDate)] || {};
    if (!Array.isArray(day.simranSessions)) day.simranSessions = [];
    day.simranSessions.push({ hours: 0, minutes: 0 });
    all[dateKey(currentDate)] = day;
    localStorage.setItem(STORAGE, JSON.stringify(all));
    renderSimran();
  };
}

renderSimran(); // render the rows after checkbox state is set
}


function renderSimran() {
  const simranContainer = document.querySelector(".simran-sessions");
  if (!simranContainer) return;

  const all = JSON.parse(localStorage.getItem(STORAGE)) || {};
  const day = all[dateKey(currentDate)] || {};
  const lang = document.documentElement.lang || "en";

  if (!Array.isArray(day.simranSessions)) day.simranSessions = [];

  // Ensure at least one sitting exists
  if (day.simranSessions.length === 0) {
    day.simranSessions.push({ hours: 0, minutes: 0 });
  }

  simranContainer.innerHTML = "";

  day.simranSessions.forEach((s, i) => {
    const row = document.createElement("div");
    row.className = "simran-row";

   row.innerHTML = `
  <div class="input-group">
    <label class="input-label label-sitting">${translations[lang].labels.sitting} ${i+1}</label>
  </div>
  <div class="input-group">
    <label class="input-label label-hours">${translations[lang].labels.hours}</label>
    <select>${Array.from({ length: 13 }, (_, h) => `<option value="${h}" ${h === s.hours ? "selected" : ""}>${h}</option>`).join("")}</select>
  </div>
  <div class="input-group">
    <label class="input-label label-minutes">${translations[lang].labels.minutes}</label>
    <select>${Array.from({ length: 12 }, (_, m) => m*5).map(v => `<option value="${v}" ${v === s.minutes ? "selected" : ""}>${v}</option>`).join("")}</select>
  </div>
  ${i > 0 ? `<button class="delete-sitting-btn">‚ùå</button>` : ""}
`;

    const [hSel, mSel] = row.querySelectorAll("select");

    // Update hours/minutes
    hSel.onchange = mSel.onchange = () => {
      s.hours = +hSel.value;
      s.minutes = +mSel.value;
      all[dateKey(currentDate)] = day;
      localStorage.setItem(STORAGE, JSON.stringify(all));
      updateChart();
    };

    // Delete sitting (only for i > 0)
    const deleteBtn = row.querySelector(".delete-sitting-btn");
    if (deleteBtn) {
      deleteBtn.onclick = () => {
        day.simranSessions.splice(i, 1);
        all[dateKey(currentDate)] = day;
        localStorage.setItem(STORAGE, JSON.stringify(all));
        renderSimran(); // re-render to update numbers
        updateChart();
      };
    }

    simranContainer.appendChild(row);
  });

  all[dateKey(currentDate)] = day;
  localStorage.setItem(STORAGE, JSON.stringify(all));
}

// Add Sitting button ‚Äì automatically labels next sitting
const addBtn = document.querySelector(".add-simran-btn");
if (addBtn) {
  addBtn.onclick = () => {
    const all = JSON.parse(localStorage.getItem(STORAGE)) || {};
    const day = all[dateKey(currentDate)] || {};
    if (!Array.isArray(day.simranSessions)) day.simranSessions = [];

    // Push a new sitting
    day.simranSessions.push({ hours: 0, minutes: 0 });

    all[dateKey(currentDate)] = day;
    localStorage.setItem(STORAGE, JSON.stringify(all));
    renderSimran(); // re-render will update numbering
    updateChart();
  };
}

function buildMonth(){
  const mv=document.getElementById("monthView");
  const all=JSON.parse(localStorage.getItem(STORAGE))||{};
  mv.innerHTML="<div class='month-grid'></div>";
  const grid=mv.firstChild;
  const y=currentDate.getFullYear(), m=currentDate.getMonth();
  const first=new Date(y,m,1), last=new Date(y,m+1,0);
  const today=new Date();

  for(let i=0;i<first.getDay();i++){
    const empty=document.createElement("div");empty.className="day empty";grid.appendChild(empty);
  }

  for(let d=1;d<=last.getDate();d++){
    const date=new Date(y,m,d);
    const data=all[dateKey(date)]||{};
    const doneCount=Object.values(data.checks||{}).filter(v=>v).length;
// Simran hours
let simranTotal = 0;

if (data.simranSessions) {
  simranTotal = data.simranSessions.reduce(
    (t, s) => t + s.hours + s.minutes / 60, 0
  );
} else if (data.simran) {
  simranTotal =
    (+data.simran.hours || 0) +
    ((+data.simran.minutes || 0) / 60);
}

// Jaap count
const jaapTotal = +data.jaapCount || 0;

    let bg="";
    if(doneCount===7) bg="#2e7d32"; else if(doneCount>=4) bg="#66bb6a"; else if(doneCount>=1) bg="#a5d6a7"; else bg="#eee";
    const el=document.createElement("div");
    el.className="day";
if(dateKey(date) > dateKey(today)){ el.classList.add("future"); }
if (dateKey(date) === dateKey(today)) {
  el.classList.add("today");
}

el.innerHTML = `
  <div>
  ${document.documentElement.lang === "en"
    ? monthNames.en[m].slice(0,3)
    : monthNames[document.documentElement.lang][m]
  } ${d}
</div>


  ${doneCount > 0 ? `
    <div style="
      display:inline-flex;
      align-items:center;
box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      gap:4px;
      margin-top:2px;
      padding:3px 8px;
      justify-content:center;
min-width: 72px;
      border-radius:999px;
      background:#e8f5e9;
      color:#1b5e20;
      font-size:0.7rem;
      font-weight:800;
      white-space:nowrap;
    ">
      ‚úî ${doneCount}/7
    </div>
  ` : ""}

  ${simranTotal > 0 ? `
    <div style="
      display:inline-flex;
      align-items:center;
box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      gap:4px;
      margin-top:2px;
      padding:3px 8px;
      justify-content:center;
min-width: 72px;
      border-radius:999px;
      background:#e3f2fd;
      color:#0d47a1;
      font-size:0.7rem;
      font-weight:800;
      white-space:nowrap;
    ">
      üïí ${simranTotal.toFixed(1)}h
    </div>
  ` : ""}

  ${jaapTotal > 0 ? `
    <div style="
      display:inline-flex;
      align-items:center;
box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      gap:4px;
      margin-top:2px;
      padding:3px 8px;
      justify-content:center;
min-width: 72px;
      border-radius:999px;
      background:#fff9c4;
      color:#1b5e20;
      font-size:0.7rem;
      font-weight:900;
      white-space:nowrap;
    ">
      üìø ${jaapTotal.toLocaleString()}
    </div>
  ` : ""}
`;

    el.style.backgroundColor=bg;
    el.style.color=(doneCount>0?"#fff":"#000");
    el.style.fontWeight="bold";
    el.style.borderRadius="5px";
   el.title =
  `${format(date)}\n` +
  `Rules: ${doneCount}/7\n` +
  (simranTotal > 0 ? `Simran: ${simranTotal.toFixed(1)}h\n` : "") +
  (jaapTotal > 0 ? `Jaap: ${jaapTotal.toLocaleString()}` : "");

    el.onclick=()=>{
   if (dateKey(date) > dateKey(today)) return;
      currentDate=date; closeModal(); loadDay(); updateChart();
    }
    grid.appendChild(el);
  }
}

const modal = document.getElementById("monthModal");
const closeBtn = document.getElementById("closeModal");
function openModal(){ modal.style.display="flex"; }
function closeModal(){ modal.style.display="none"; }
document.getElementById("toggleMonth").onclick=()=>{buildMonth(); openModal();}
closeBtn.onclick = closeModal;
window.onclick = e=>{ if(e.target==modal) closeModal(); }

document.getElementById("prevDay").onclick=()=>{currentDate.setDate(currentDate.getDate()-1);loadDay(); updateChart(); updateChartMonthTitle(document.documentElement.lang);}
document.getElementById("nextDay").onclick=()=>{currentDate.setDate(currentDate.getDate()+1);loadDay(); updateChart();  updateChartMonthTitle(document.documentElement.lang);}
document.getElementById("todayBtn").onclick = () => { currentDate=new Date(); loadDay(); updateChart(); updateChartMonthTitle(document.documentElement.lang); }


let habitChart, simranChart, jaapChart;

function updateChart() {
  const all = JSON.parse(localStorage.getItem(STORAGE)) || {};
  const y = currentDate.getFullYear();
  const m = currentDate.getMonth();

  const days = Array.from(
    { length: new Date(y, m + 1, 0).getDate() },
    (_, i) => i + 1
  );

  const habitData = days.map(d => {
    const val = all[dateKey(new Date(y, m, d))] || {};
    return Object.values(val.checks || {}).filter(v => v).length;
  });

const simranHours = days.map(d => {
  const val = all[dateKey(new Date(y, m, d))];

  if (val?.simranSessions) {
    return val.simranSessions.reduce(
      (t, s) => t + s.hours + s.minutes / 60, 0
    );
  }

  if (val?.simran) {
    return (+val.simran.hours || 0) +
           ((+val.simran.minutes || 0) / 60);
  }

  return 0;
});

  const jaapCounts = days.map(d => {
    const val = all[dateKey(new Date(y, m, d))];
    return +val?.jaapCount || 0;
  });

  habitChart = renderLineChart(
    "habitChart",
    habitChart,
    habitData,
    7,
    "#8e24aa",
    v => v
  );

simranChart = renderLineChart(
  "simranChart",
  simranChart,
  simranHours,
  null,
  "#1565c0",
  v => (v > 0 ? v.toFixed(1) : "") // ‚úÖ show hours
);


  jaapChart = renderLineChart(
    "jaapChart",
    jaapChart,
    jaapCounts,
    null,
    "#2e7d32",
    v => (v > 0 ? v.toLocaleString() : "")
  );
}

function renderLineChart(canvasId, chartRef, data, maxY, color, formatter) {
  const ctx = document.getElementById(canvasId).getContext("2d");
  if (chartRef) chartRef.destroy();

  return new Chart(ctx, {
    type: "line",
    plugins: [ChartDataLabels],  // Ensure the plugin is being used
    data: {
      labels: data.map((_, i) => i + 1),
      datasets: [{
        data,
        borderColor: color,
        backgroundColor: color + "33",  // Set the chart background color
        tension: 0.3,  // For smooth curves
        fill: true,  // Fill the area under the line
        pointRadius: 5,  // Make the points visible
        datalabels: {
          display: true,  // Ensure labels are shown
          align: "end",  // Positioning the labels above the points
	  offset: 4,
          color: color,  // Text color of the labels
          font: { weight: "bold", size: 11 },  // Font style for labels
          formatter: formatter,  // Use the formatter function passed in
        }
      }]
    },
options: {
  responsive: true,
  maintainAspectRatio: false,
  layout: {
    padding: {
      top: 22   // ‚úÖ prevents label cut-off
    }
  },
  plugins: {
    legend: { display: false },
    tooltip: { enabled: false },
    datalabels: {
      clip: false   // ‚úÖ allow labels outside chart area
    }
  },
  scales: {
x: {
    ticks: {
      autoSkip: false,   // ‚úÖ show every day
      maxRotation: 0,
      minRotation: 0,
      font: { size: 10 }
    }
  },
    y: {
      beginAtZero: true,
      max: maxY || undefined,
      display: false
    }
  }
}

  });
}

function toggleChart(chartId, btn) {
  const chartContainer = document.getElementById(chartId + "Container");

  if (chartContainer.style.display === "none") {
    chartContainer.style.display = "block";
    btn.textContent = "‚ñ≤";
  } else {
    chartContainer.style.display = "none";
    btn.textContent = "‚ñº";
  }
}


const translations = {
  pa: {
    headerLine1: "‡®ó‡©Å‡®∞‡®Æ‡©±‡®§ ‡®°‡®ø‡®ú‡®º‡©Ä‡®ü‡®≤ ‡®°‡®æ‡®á‡®∞‡©Ä",
    headerTitle: "‡®∏‡®§‡®ø‡®ó‡©Å‡®∞ ‡®∏‡©á‡®§‡©Ä ‡®∞‡®§‡®ø‡®Ü ‡®¶‡®∞‡®ó‡®π ‡®™‡®æ‡®à‡®ê ‡®†‡®æ‡®â ‡••",
    todayBtn: "‡®Ö‡©±‡®ú ‡®¶‡©Ä ‡®§‡®∞‡©Ä‡®ï ‡®§‡©á ‡®ú‡®æ‡®ì",
    toggleMonth: "‡®Æ‡®π‡©Ä‡®®‡®æ‡®µ‡®æ‡®∞ ‡®¶‡®∞‡®∏‡®º‡®®",
    footerText: "‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç ‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç ‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç ‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç ‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç ‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç",
labels: {
  sitting: "‡®¨‡©à‡®†‡®ï",
  hours: "‡®ò‡©∞‡®ü‡©á",
  minutes: "‡®Æ‡®ø‡©∞‡®ü",
  jaap: "‡®ï‡®æ‡®â‡®Ç‡®ü‡®∞ ‡®ú‡®æ‡®™ ‡®¶‡©Ä ‡®ó‡®ø‡®£‡®§‡©Ä"
},
  chartTitles: {
    habits: "‡®™‡©Ç‡®∞‡©á ‡®ï‡©Ä‡®§‡©á ‡®®‡®ø‡®Ø‡®Æ",
    simran: "‡®∏‡®ø‡®Æ‡®∞‡®® ‡®∏‡®Æ‡®æ‡®Ç (‡®ò‡©∞‡®ü‡©á)",
    jaap: "‡®ú‡®æ‡®™ ‡®¶‡©Ä ‡®ó‡®ø‡®£‡®§‡©Ä"
  },
monthTitle: "‡®Æ‡®π‡©Ä‡®®‡®æ‡®µ‡®æ‡®∞ ‡®¶‡®∞‡®∏‡®º‡®®",
    habits: [
"‡®ï‡©Ä ‡®Æ‡©à‡®Ç ‡®Ö‡©±‡®ú ‡®¨‡®æ‡®£‡©Ä ‡®µ‡®ø‡®ö‡®æ‡®∞ ‡®µ‡®ø‡®ö‡®æ‡®∞ ‡®ï‡©á ‡®™‡©ú‡©ç‡®π‡©Ä ‡®π‡©à ? (‡®∏‡®Æ‡®ù‡®£ ‡®¶‡©á ‡®Æ‡®®‡©ã‡®∞‡®• ‡®≤‡®à)",
"‡®ï‡©Ä ‡®Æ‡©à‡®Ç ‡®Ö‡©±‡®ú ‡®∏‡©∞‡®ó‡®§ ‡®ï‡©Ä‡®§‡©Ä ‡®π‡©à ? (‡®ó‡®ø‡®Ü‡®® ‡®™‡©ç‡®∞‡®æ‡®™‡®§ ‡®ï‡®∞‡®® ‡®≤‡®à)",
"‡®ï‡©Ä ‡®Ö‡©±‡®ú ‡®Æ‡©á‡®∞‡®æ ‡®Æ‡®® ‡®∏‡©∞‡®∏‡®æ‡®∞ ‡®Ö‡©∞‡®¶‡®∞ ‡®∏‡®æ‡®µ‡®ß‡®æ‡®® ‡®π‡©ã ‡®ï‡©á ‡®µ‡®ø‡®ö‡®∞‡®ø‡®Ü ? (‡®¨‡®ø‡©±‡®¨‡®∞‡®ú‡®ø‡®§ ‡®ï‡®∞‡®Æ‡®æ‡®Ç ‡®§‡©ã‡®Ç ‡®¨‡®ö‡®£ ‡®≤‡®à)",
"‡®ï‡©Ä ‡®Æ‡©à‡®Ç ‡®Ö‡©±‡®ú ‡®á‡®ï‡®æ‡®Ç‡®§ ‡®∏‡®ø‡®Æ‡®∞‡®® ‡®¶‡©Ä ‡®π‡®æ‡©õ‡®∞‡©Ä ‡®≤‡®ó‡®æ‡®à ‡®π‡©à? (‡®ò‡©±‡®ü‡©ã ‡®ò‡©±‡®ü 1 ‡®ò‡©∞‡®ü‡©á ‡®¶‡©Ä)",
"‡®ï‡©Ä ‡®Æ‡©à‡®Ç ‡®Ö‡©±‡®ú ‡®§‡©Å‡®∞‡®¶‡©á ‡®´‡®ø‡®∞‡®¶‡©á ‡®µ‡®æ‡®π‡®ø‡®ó‡©Å‡®∞‡©Ç ‡®¶‡®æ ‡®ú‡®æ‡®™ ‡®ï‡©Ä‡®§‡®æ ? (‡®Æ‡®® ‡®®‡©Ç ‡®µ‡®ø‡®ö‡®æ‡®∞‡®æ‡®Ç ‡®¶‡©Ä ‡®Æ‡©à‡®≤ ‡®≤‡©±‡®ó‡®£ ‡®§‡©ã‡®Ç ‡®¨‡®ö‡®æ‡®â‡®£ ‡®≤‡®à)",
"‡®ï‡©Ä ‡®Æ‡©à‡®Ç ‡®Ö‡©±‡®ú ‡®Ö‡®®‡®π‡®¶ ‡®∂‡®¨‡®¶‡®æ‡®Ç ‡®®‡©Ç ‡®è‡®ï‡®æ‡®Ç‡®§ ‡®µ‡®ø‡©±‡®ö ‡®¨‡©à‡®† ‡®ï‡©á ‡®∏‡©Å‡®£‡®ø‡®Ü? (‡®∏‡©Å‡®∞‡®§ ‡®®‡©Ç ‡®∂‡®¨‡®¶ ‡®®‡®æ‡®≤ ‡®ú‡©ã‡©ú‡®® ‡®≤‡®à)",
"‡®ï‡©Ä ‡®Æ‡©à‡®Ç ‡®Ö‡©±‡®ú ‡®è‡®ï‡®æ‡®Ç‡®§ ‡®µ‡®ø‡©±‡®ö ‡®¨‡©à‡®† ‡®ï‡©á ‡®∏‡®æ‡®π‡®Æ‡®£‡©á ‡®∏‡©Å‡©∞‡®® ‡®µ‡®ø‡©±‡®ö ‡®¶‡©á‡®ñ‡®£ ‡®¶‡©Ä ‡®ï‡©ã‡®∂‡®ø‡®∂ ‡®ï‡©Ä‡®§‡©Ä? (‡®™‡©ç‡®∞‡®ï‡®æ‡®∂ ‡®∞‡©Ç‡®™ ‡®™‡®∞‡®Æ‡®æ‡®§‡®Æ‡®æ ‡®¶‡©á ‡®¶‡®∞‡®∂‡®® ‡®ï‡®∞‡®® ‡®≤‡®à)"
    ]
  },

  hi: {
    headerLine1: "‡§ó‡•Å‡§∞‡§Æ‡§§ ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§°‡§æ‡§Ø‡§∞‡•Ä",
    headerTitle: "‡§∏‡§§‡§ø‡§ó‡•Å‡§∞ ‡§∏‡•á‡§§‡•Ä ‡§∞‡§§‡§ø‡§Ø‡§æ ‡§¶‡§∞‡§ó‡§π ‡§™‡§æ‡§á‡§è ‡§†‡§æ‡§ä ‡••",
    todayBtn: "‡§Ü‡§ú ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§™‡§∞ ‡§ú‡§æ‡§ì",
    toggleMonth: "‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§¶‡•É‡§∂‡•ç‡§Ø",
    footerText: "‡§µ‡§æ‡§π‡•á‡§ó‡•Å‡§∞‡•Å ‡§µ‡§æ‡§π‡•á‡§ó‡•Å‡§∞‡•Å ‡§µ‡§æ‡§π‡•á‡§ó‡•Å‡§∞‡•Å ‡§µ‡§æ‡§π‡•á‡§ó‡•Å‡§∞‡•Å ‡§µ‡§æ‡§π‡•á‡§ó‡•Å‡§∞‡•Å ‡§µ‡§æ‡§π‡•á‡§ó‡•Å‡§∞‡•Å",
labels: {
  sitting: "‡§¨‡•à‡§†‡§ï",
  hours: "‡§ò‡§Ç‡§ü‡•á",
  minutes: "‡§Æ‡§ø‡§®‡§ü",
  jaap: "‡§ï‡§æ‡§â‡§Ç‡§ü‡§∞ ‡§ú‡§æ‡§™ ‡§ï‡•Ä ‡§ó‡§ø‡§®‡§§‡•Ä"
},
  chartTitles: {
    habits: "‡§™‡•Ç‡§∞‡•á ‡§ï‡§ø‡§è ‡§®‡§ø‡§Ø‡§Æ",
    simran: "‡§∏‡•ç‡§Æ‡§∞‡§£ ‡§∏‡§Æ‡§Ø (‡§ò‡§Ç‡§ü‡•á)",
    jaap: "‡§ú‡§™ ‡§ï‡•Ä ‡§ó‡§ø‡§®‡§§‡•Ä"
  },
 monthTitle: "‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§¶‡•É‡§∂‡•ç‡§Ø",
    habits: [
"‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ü‡§ú ‡§¨‡§æ‡§£‡•Ä ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§ï‡§∞ ‡§™‡§¢‡§º‡•Ä ‡§π‡•à? (‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•á ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø ‡§∏‡•á)",
"‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ü‡§ú ‡§∏‡§Ç‡§ó‡§§ ‡§ï‡•Ä ‡§π‡•à? (‡§ú‡•ç‡§û‡§æ‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)",
"‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§ú ‡§Æ‡•á‡§∞‡§æ ‡§Æ‡§® ‡§∏‡§Ç‡§∏‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§∏‡§æ‡§µ‡§ß‡§æ‡§® ‡§π‡•ã‡§ï‡§∞ ‡§µ‡§ø‡§ö‡§∞‡§ø‡§§ ‡§π‡•Å‡§Ü? (‡§¨‡§ø‡§¨‡§∞‡§ú‡•Ä‡§§ ‡§ï‡§∞‡•ç‡§Æ‡•ã‡§Ç ‡§∏‡•á ‡§¨‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)",
"‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ü‡§ú ‡§è‡§ï‡§æ‡§®‡•ç‡§§ ‡§∏‡•ç‡§Æ‡§∞‡§£ ‡§ï‡•Ä ‡§π‡§æ‡§ú‡§º‡§ø‡§∞‡•Ä ‡§≤‡§ó‡§æ‡§à ‡§π‡•à? (‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 1 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡•Ä)",
"‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ü‡§ú ‡§ö‡§≤‡§§‡•á-‡§´‡§ø‡§∞‡§§‡•á ‡§µ‡§π‡§ø‡§ó‡•Å‡§∞‡•Å ‡§ï‡§æ ‡§ú‡§æ‡§™ ‡§ï‡§ø‡§Ø‡§æ? (‡§Æ‡§® ‡§ï‡•ã ‡§µ‡§ø‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§Æ‡•à‡§≤ ‡§≤‡§ó‡§®‡•á ‡§∏‡•á ‡§¨‡§ö‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)",
"‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ü‡§ú ‡§Ö‡§®‡§π‡§¶ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•ã ‡§è‡§ï‡§æ‡§®‡•ç‡§§ ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§†‡§ï‡§∞ ‡§∏‡•Å‡§®‡§æ? (‡§∏‡•Ç‡§∞‡§§ ‡§ï‡•ã ‡§∂‡§¨‡•ç‡§¶ ‡§∏‡•á ‡§ú‡•ã‡§°‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)",
"‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ü‡§ú ‡§è‡§ï‡§æ‡§®‡•ç‡§§ ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§†‡§ï‡§∞ ‡§∏‡§æ‡§Æ‡§®‡•á ‡§∏‡•Å‡§® ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡•Ä? (‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§∞‡•Ç‡§™ ‡§™‡§∞‡§Æ‡§æ‡§§‡•ç‡§Æ‡§æ ‡§ï‡•á ‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è)"
    ]
  },

  en: {
    headerLine1: "Gurmat Digital Diary",
    headerTitle: "‡®∏‡®§‡®ø‡®ó‡©Å‡®∞ ‡®∏‡©á‡®§‡©Ä ‡®∞‡®§‡®ø‡®Ü ‡®¶‡®∞‡®ó‡®π ‡®™‡®æ‡®à‡®ê ‡®†‡®æ‡®â ‡••",
    todayBtn: "Go To Today's Date",
    toggleMonth: "Monthly View",
    footerText: "Waheguru Waheguru Waheguru Waheguru Waheguru Waheguru",
labels: {
  sitting: "Sitting",
  hours: "Hours",
  minutes: "Minutes",
  jaap: "Jaap Counter"
},
chartTitles: {
  habits: "Rules Completed",
  simran: "Simran Time (Hours)",
  jaap: "Jaap Count"
},
monthTitle: "Monthly View",
    habits: [
"Did I read and contemplate the Bani thoughtfully today (for the purpose of understanding)?",
"Did I connect with the sangat today? (to gain Gurmat knowledge)",
"Did my mind wander carefully in the world today? (To avoid accruing wrongful actions)",
"Did I practice solitary meditation (ekaant simran) today? (At least for 1 hour)",
"Did I chant Waheguru today while walking around? (To protect the mind from getting polluted with thoughts)",
"Did I sit in solitude today and listen to the Anhad words? (To connect the consciousness with the Naam)",
"Did I sit in solitude and try to see the void before me today? (To experience the divine in the form of light)"
    ]
  }
};

function applyLanguage(lang) {
  const t = translations[lang];
  localStorage.setItem("lang", lang);

document.documentElement.lang = lang;


  // Header
  document.getElementById("headerLine1").textContent = t.headerLine1;
  document.getElementById("headerTitle").textContent = t.headerTitle;
  document.getElementById("todayBtn").textContent = t.todayBtn;
  document.getElementById("toggleMonth").textContent = t.toggleMonth;
  document.getElementById("footerText").textContent = t.footerText;
  document.getElementById("monthTitle").textContent = t.monthTitle;

  // Chart titles
  document.getElementById("chartTitleHabits").textContent = t.chartTitles.habits;
  document.getElementById("chartTitleSimran").textContent = t.chartTitles.simran;
  document.getElementById("chartTitleJaap").textContent = t.chartTitles.jaap;

  // Habit text
  t.habits.forEach((text, i) => {
    const el = document.getElementById(`habit-${i}`);
    if (el) el.textContent = text;
  });

  // Input labels
 document.querySelectorAll(".label-hours").forEach(el => {
  el.textContent = t.labels.hours;
});

document.querySelectorAll(".label-minutes").forEach(el => {
  el.textContent = t.labels.minutes;
});

document.querySelectorAll(".simran-row").forEach((row, i) => {
  const sittingLabel = row.querySelector(".label-sitting");
  const hoursLabel = row.querySelector(".label-hours");
  const minutesLabel = row.querySelector(".label-minutes");

  if (sittingLabel) sittingLabel.textContent = `${t.labels.sitting} ${i + 1}`;
  if (hoursLabel) hoursLabel.textContent = t.labels.hours;
  if (minutesLabel) minutesLabel.textContent = t.labels.minutes;
});

document.querySelectorAll(".label-jaap").forEach(el => {
  el.textContent = t.labels.jaap;
});

updateChartMonthTitle(lang);



loadDay();
buildMonth();
updateChart();

}
// üîß Language initialization (FIX)
const savedLang = localStorage.getItem("lang") || "pa";
applyLanguage(savedLang);

const languageSelect = document.getElementById("languageSelect");
if (languageSelect) {
  languageSelect.value = savedLang;
  languageSelect.onchange = e => {
    applyLanguage(e.target.value);
  };
}

</script>
</body>
</html>
